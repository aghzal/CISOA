{% load static %}
{% load tailwind_tags %}

{% load i18n %}

<!doctype html>
<html class="overflow-x-hidden" lang="en">

<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.0/css/all.min.css" rel="stylesheet">
    {% tailwind_css %}
    <script src="{% static "js/cdn.min.js" %}" defer></script>
    {% block head %}{% endblock %}

    <title>MIRA</title>

</head>
<body class="bg-gray-50">
	<style>
		[x-cloak] { display: none }
	</style>
	<div x-data="{ sidebarOpen: true }" class="flex h-screen">
        <div class="flex flex-grow w-2/5 mt-2 mb-5 ml-96 fixed z-2">
            <div class="flex-grow ml-72 mr-4">
                <search>
                    <form action="{% url 'search' %}" class="">
                        <span class="h-10 m-0 bg-gray-200 hover:bg-gray-300 cursor-pointer border border-gray-300 text-sm rounded-full flex">
                            <input id="search" required type="search" name="q" placeholder="{% trans "Search Risk instance, mitigation, analysis ..." %}" value="{{request.GET.q}}"
                                    class="flex-grow px-4 rounded-l-full rounded-r-full text-sm focus:outline-none border-none overflow-ellipsis">
                            <button id="submit" type="submit" class="text-gray-700">
                                    <i class="fas fa-search text-lg w-4 h-4 ml-2 mr-4"></i>
                            </button>
                        </span>
                    </form>
                </search>
            </div>
            <div class="mr-5 my-auto sm:hidden border border-gray-300 py-2 px-3 rounded-lg">
                <i class="fas fa-bars text-gray-100"></i>
            </div>
        </div>
		<aside class="flex-shrink-0 w-72 flex flex-col shadow transition-all duration-300 fixed h-screen overflow-y-auto left-0"
			:class="{ '-ml-64': !sidebarOpen }">
			<nav class="flex-1 flex flex-col overflow-y-auto bg-white">
                <a href="/">
                    <div class="flex items-center justify-center p-3">
                        <svg height="128" width="128" id="a" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><defs><style>.b,.c{fill:#694998;}.c{opacity:.15;}</style></defs><g><path class="b" d="M342.11,142.79l-11.34-59.33c-62.57,12.14-116.99,22.39-163.27,30.76-46.28,8.36-71.52,12.86-75.73,13.47l-5.2,60.77c2.73,1.12,21.87,8.86,57.43,23.23,35.56,14.37,68.89,27.94,99.99,40.7v1.49c-39.15,15.98-73.97,29.99-104.45,42-30.48,12.02-48.13,18.89-52.97,20.63l6.32,59.66c7.19,1.49,34.17,6.91,80.94,16.26,46.77,9.36,99.15,20.54,157.13,33.54l10.96-57.52c-36.57-6.42-72.15-13.14-106.73-20.18-34.58-7.03-54.85-11.17-60.81-12.4l.04-.94c6.2-2.6,23.21-9.85,51.03-21.75,27.82-11.9,56.98-23.61,87.47-35.14v-46.28c-30.53-11.66-59.35-23.21-86.47-34.63-27.12-11.42-44.52-18.8-52.21-22.15l.29-1,167.58-31.2Z"/><rect class="b" x="365.9" y="162.81" width="58.91" height="43.86"/><path class="b" d="M423.88,236.22h-57.05c.25,19.58,.4,37.17,.46,52.78,.06,15.61,.09,30.54,.09,44.79,0,16.85-.09,34.94-.28,54.27-.19,19.33-.28,31.97-.28,37.91h57.05c0-5.58-.12-15.7-.37-30.39-.25-14.68-.37-36.15-.37-64.4,0-17.72,.09-33.55,.28-47.48,.19-13.94,.34-29.76,.46-47.48Z"/></g><polygon class="c" points="480.91 253.74 68.58 15.68 68.58 491.8 480.91 253.74"/></svg>
                    </div>
                    <div class="flex items-center justify-center h-14 py-2">
                        <div id="title" class="text-xl text-indigo-900"><span class="font-semibold">MIRA</span> <i class="fas fa-circle-notch"></i> <span class="font-bold">Viewer</span></div>
                    </div>
                </a>
				<div class="overflow-y-auto overflow-x-hidden flex-grow">
					<ul class="flex flex-col py-4 space-y-1">
                        <li class="nav-seperator text-md">
							<div class="flex flex-row items-center h-8 border-b border-t">
								<span class="inline-flex ml-16 pl-3">
                                    {% if user.is_authenticated %}
									<i class="fas fa-user-circle"></i> 
								</span>
								<span class="ml-2 text-sm tracking-wide truncate">{% trans "Hello" %}, {{user}}
                                    {% else %}
                                    {% trans "You're not logged in" %}
                                    {% endif %}</span>
                                </div>
						</li>
						<li>
							<a id="edit" href="/back-office/"
								class="relative flex flex-row items-center pr-6 nav-link">
								<span class="inline-flex justify-center items-center ml-4">
									<i class="fas fa-edit"></i>
								</span>
								<span class="ml-2 text-sm tracking-wide truncate">{% trans "Edit" %}</span>
							</a>
						</li>
                        <li>
							<a id="analytics" href="{% url 'analytics' %}"
								class="relative flex flex-row items-center pr-6 nav-link">
								<span class="inline-flex justify-center items-center ml-4">
									<i class="fas fa-chart-pie"></i>
								</span>
								<span class="ml-2 text-sm tracking-wide truncate">{% trans "Analytics" %}</span>
							</a>
						</li>
                        <li>
							<a id="myprojects" href="{% url 'my_projects' %}"
								class="relative flex flex-row items-center pr-6 nav-link">
								<span class="inline-flex justify-center items-center ml-4">
									<i class="fas fa-star"></i>
								</span>
								<span class="ml-2 text-sm tracking-wide truncate">{% trans "My Projects" %}</span>
							</a>
						</li>
                        <li>
							<a id="calendar" href="{% url 'calendar' %}"
								class="relative flex flex-row items-center pr-6 nav-link">
								<span class="inline-flex justify-center items-center ml-4">
									<i class="fas fa-calendar-alt"></i> 
								</span>
								<span class="ml-2 text-sm tracking-wide truncate">{% trans "Calendar" %}</span>
							</a>
						</li>
                        <li>
							<a id="composer" href="{% url 'composer' %}"
								class="relative flex flex-row items-center pr-6 nav-link">
								<span class="inline-flex justify-center items-center ml-4">
									<i class="fas fa-drafting-compass"></i> 
								</span>
								<span class="ml-2 text-sm tracking-wide truncate">{% trans "Composer" %}</span>
							</a>
						</li>
                        <li>
							<a href="{% url 'logout' %}"
								class="relative flex flex-row items-center pr-6 nav-link">
								<span class="inline-flex justify-center items-center ml-4">
									<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"
										xmlns="http://www.w3.org/2000/svg">
										<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
											d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1">
										</path>
									</svg>
								</span>
								<span class="ml-2 text-sm tracking-wide truncate">{% trans "Sign Out" %}</span>
							</a>
						</li>
                        <li>
							<a id="translation"
								class="relative flex flex-row items-center pr-6 nav-link">
								<span class="inline-flex justify-center items-center ml-4">
									<i class="fas fa-language"></i>              
								</span>
								<span class="ml-2 mr-4 text-sm tracking-wide truncate">{% trans "Language" %}</span>
                                <form action="{% url 'set_language' %}" method="post">
                                    {% csrf_token %}
                                    <select id="language" class=" border-none block text-sm capitalize text-gray-700 hover:bg-violet-900 hover:text-white" name="language" onchange="this.form.submit();"> 
                                        {% get_current_language as LANGUAGE_CODE %} 
                                        {% get_available_languages as LANGUAGES %}
                                        {% get_language_info_list for LANGUAGES as languages %}
                                        {% for language in languages %}
                                            <option value="{{ language.code }}"{% if language.code == LANGUAGE_CODE %} selected {% endif %}> 
                                                {{ language.name_local }} ({{ language.code }})
                                            </option>
                                        {% endfor %}
                                    </select>
                                </form>
							</a>
						</li>
					</ul>
				</div>
			</nav>
		</aside>
        <!-- SIDEBAR TOGGLE -->
        <button class="fixed left-64 ml-8 transition-all duration-300 w-6 h-6 rounded-full content-center self-center bg-indigo-900 shadow shadow-blue-500/50 text-white hover:scale-125"  @click="sidebarOpen = !sidebarOpen" :class="{ '-ml-64': sidebarOpen == false }">
            <i class="fas fa-angle-left transition-all duration-100" :class="{ 'rotate-180': sidebarOpen == false }"></i>
        </button>
        <div class="flex-1">
            <main class="px-8 pb-8 transition-all duration-300 ml-72" :class="sidebarOpen == false ? 'ml-0' : 'ml-72'">
            {% block content %}
            {% endblock %}
        </main>
		</div>
	</div>
</body>




</html>
