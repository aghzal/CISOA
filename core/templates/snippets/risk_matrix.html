{% load i18n back_office_extras %}

<table class="w-full p-2">
    {% for row in matrix.render_grid_as_colors reversed %}
        {% with row_index=forloop.revcounter0 %}
            <tr class="w-full">
                <td class="w-8 text-right pr-2">
                    {% with impact=matrix.parse_json.impact|index:row_index %}
                    {{ impact.name }}
                    {% endwith %}
                </td>
                {% for item in row %}
                    <td class="w-8 h-16 text-center" style="background-color: {{ item.rgb }}">
                        {{ data|index:row_index|index:forloop.counter0|join:", " }}
                    </td>
                {% endfor %}
            </tr>
        {% endwith %}
    {% endfor %}
    <tr>
        <td></td>
        {% for probability in matrix.parse_json.probability %}
            <td class="w-8 h-16 text-center">
                {{ probability.name }}
            </td>
        {% endfor %}
    </tr>
</table>

{% comment %} {% if matrix == 'default' %}

<table class="w-full p-2">
    <tr>
        <td class="text-right font-semibold px-2">{% trans "Impact" %}</td>
    </tr>
    <tr>
        <td class="text-right h-16 px-2">{% trans "Very high" %}</td>
        <td class="w-1/6 text-center M">{% if data.0.0 %}{{data.0.0|join:", "}}{% endif %}</td>
        <td class="w-1/6 text-center M">{% if data.0.1 %}{{data.0.1|join:", "}}{% endif %}</td>
        <td class="w-1/6 text-center H">{% if data.0.2 %}{{data.0.2|join:", "}}{% endif %}</td>
        <td class="w-1/6 text-center VH">{% if data.0.3 %}{{data.0.3|join:", "}}{% endif %}</td>
        <td class="w-1/6 text-center VH">{% if data.0.4 %}{{data.0.4|join:", "}}{% endif %}</td>
    </tr>
    <tr>
        <td class="text-right h-16 px-2">{% trans "High" %}</td>
        <td class="text-center L">{% if data.1.0 %}{{data.1.0|join:", "}}{% endif %}</td>
        <td class="text-center M">{% if data.1.1 %}{{data.1.1|join:", "}}{% endif %}</td>
        <td class="text-center M">{% if data.1.2 %}{{data.1.2|join:", "}}{% endif %}</td>
        <td class="text-center H">{% if data.1.3 %}{{data.1.3|join:", "}}{% endif %}</td>
        <td class="text-center VH">{% if data.1.4 %}{{data.1.4|join:", "}}{% endif %}</td>
    </tr>
    <tr>
        <td class="text-right h-16 px-2">{% trans "Medium" %}</td>
        <td class="text-center L">{% if data.2.0 %}{{data.2.0|join:", "}}{% endif %}</td>
        <td class="text-center L">{% if data.2.1 %}{{data.2.1|join:", "}}{% endif %}</td>
        <td class="text-center M">{% if data.2.2 %}{{data.2.2|join:", "}}{% endif %}</td>
        <td class="text-center M">{% if data.2.3 %}{{data.2.3|join:", "}}{% endif %}</td>
        <td class="text-center H">{% if data.2.4 %}{{data.2.4|join:", "}}{% endif %}</td>
    </tr>
    <tr>
        <td class="text-right h-16 px-2">{% trans "Low" %}</td>
        <td class="text-center VL">{% if data.3.0 %}{{data.3.0|join:", "}}{% endif %}</td>
        <td class="text-center L">{% if data.3.1 %}{{data.3.1|join:", "}}{% endif %}</td>
        <td class="text-center L">{% if data.3.2 %}{{data.3.2|join:", "}}{% endif %}</td>
        <td class="text-center M">{% if data.3.3 %}{{data.3.3|join:", "}}{% endif %}</td>
        <td class="text-center M">{% if data.3.4 %}{{data.3.4|join:", "}}{% endif %}</td>
    </tr>
    <tr>
        <td class="text-right h-16 px-2">{% trans "Very low" %}</td>
        <td class="text-center VL">{% if data.4.0 %}{{data.4.0|join:", "}}{% endif %}</td>
        <td class="text-center VL ">{% if data.4.1 %}{{data.4.1|join:", "}}{% endif %}</td>
        <td class="text-center L">{% if data.4.2 %}{{data.4.2|join:", "}}{% endif %}</td>
        <td class="text-center L">{% if data.4.3 %}{{data.4.3|join:", "}}{% endif %}</td>
        <td class="text-center M">{% if data.4.4 %}{{data.4.4|join:", "}}{% endif %}</td>
    </tr>
    <tr>
        <td class=""></td>
        <td class="text-center">{% trans "Very low" %}</td>
        <td class="text-center">{% trans "Low" %}</td>
        <td class="text-center">{% translate "Medium" context "Probability" %}</td>
        <td class="text-center">{% translate "High" context "Probability" %}</td>
        <td class="text-center">{% translate "Very high" context "Probability" %}</td>
        <td class="font-semibold px-2">{% trans "Probability" %}</td>
    </tr>

</table>
{% endif %}

{% if matrix == 'critical' %}
<table class="w-full p-2">
    <tr>
        <td class="text-right font-semibold px-2">{% trans "Impact" %}</td>
    </tr>
    <tr>
        <td class=" text-right h-16 px-2">{% trans "Very high" %}</td>
        <td class="w-1/6 text-center M">{% if data.0.0 %}{{data.0.0|join:", "}}{% endif %}</td>
        <td class="w-1/6 text-center H">{% if data.0.1 %}{{data.0.1|join:", "}}{% endif %}</td>
        <td class="w-1/6 text-center VH">{% if data.0.2 %}{{data.0.2|join:", "}}{% endif %}</td>
        <td class="w-1/6 text-center VH">{% if data.0.3 %}{{data.0.3|join:", "}}{% endif %}</td>
        <td class="w-1/6 text-center VH">{% if data.0.4 %}{{data.0.4|join:", "}}{% endif %}</td>
    </tr>
    <tr>
        <td class="text-right h-16 px-2">{% trans "High" %}</td>
        <td class="text-center L">{% if data.1.0 %}{{data.1.0|join:", "}}{% endif %}</td>
        <td class="text-center M">{% if data.1.1 %}{{data.1.1|join:", "}}{% endif %}</td>
        <td class="text-center H">{% if data.1.2 %}{{data.1.2|join:", "}}{% endif %}</td>
        <td class="text-center VH">{% if data.1.3 %}{{data.1.3|join:", "}}{% endif %}</td>
        <td class="text-center VH">{% if data.1.4 %}{{data.1.4|join:", "}}{% endif %}</td>
    </tr>
    <tr>
        <td class="text-right h-16 px-2">{% trans "Medium" %}</td>
        <td class="text-center VL">{% if data.2.0 %}{{data.2.0|join:", "}}{% endif %}</td>
        <td class="text-center L">{% if data.2.1 %}{{data.2.1|join:", "}}{% endif %}</td>
        <td class="text-center M">{% if data.2.2 %}{{data.2.2|join:", "}}{% endif %}</td>
        <td class="text-center H">{% if data.2.3 %}{{data.2.3|join:", "}}{% endif %}</td>
        <td class="text-center VH">{% if data.2.4 %}{{data.2.4|join:", "}}{% endif %}</td>
    </tr>
    <tr>
        <td class="text-right h-16 px-2">{% trans "Low" %}</td>
        <td class="text-center VL">{% if data.3.0 %}{{data.3.0|join:", "}}{% endif %}</td>
        <td class="text-center VL">{% if data.3.1 %}{{data.3.1|join:", "}}{% endif %}</td>
        <td class="text-center L">{% if data.3.2 %}{{data.3.2|join:", "}}{% endif %}</td>
        <td class="text-center M">{% if data.3.3 %}{{data.3.3|join:", "}}{% endif %}</td>
        <td class="text-center H">{% if data.3.4 %}{{data.3.4|join:", "}}{% endif %}</td>
    </tr>
    <tr>
        <td class="text-right h-16 px-2">{% trans "Very low" %}</td>
        <td class="text-center VL">{% if data.4.0 %}{{data.4.0|join:", "}}{% endif %}</td>
        <td class="text-center VL ">{% if data.4.1 %}{{data.4.1|join:", "}}{% endif %}</td>
        <td class="text-center VL">{% if data.4.2 %}{{data.4.2|join:", "}}{% endif %}</td>
        <td class="text-center L">{% if data.4.3 %}{{data.4.3|join:", "}}{% endif %}</td>
        <td class="text-center M">{% if data.4.4 %}{{data.4.4|join:", "}}{% endif %}</td>
    </tr>
    <tr>
        <td class=""></td>
        <td class="text-center">{% trans "Very low" %}</td>
        <td class="text-center">{% trans "Low" %}</td>
        <td class="text-center">{% translate "Medium" context "Probability" %}</td>
        <td class="text-center">{% translate "High" context "Probability" %}</td>
        <td class="text-center">{% translate "Very high" context "Probability" %}</td>
        <td class="font-semibold px-2">{% trans "Probability" %}</td>
    </tr>

</table>
{% endif %}

{% if matrix == 'custom' %}
Coming soon
{% endif %} {% endcomment %}