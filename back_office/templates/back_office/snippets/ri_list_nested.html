{% load i18n %}
{% load static tailwind_tags %}

<div class="mt-6" x-data="{ open: false }">
    <button class="px-4 py-2 text-white bg-blue-500 hover:bg-blue-600 rounded select-none no-outline focus:shadow-outline" @click="open = true">New Risk Instance (modal)</button>
    <!-- Dialog (full screen) -->
    <div class="absolute top-0 left-0 flex items-center justify-center w-full h-full" style="background-color: rgba(0,0,0,.5);" x-show="open"  >
        <!-- A basic modal dialog with title, body and one button to close -->
        <div class="h-auto p-4 mx-2 text-left bg-white rounded shadow-xl md:max-w-xl md:p-6 lg:p-8 md:mx-0" @click.away="open = false">
            <div class="mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left">
                <h3 class="text-lg font-medium leading-6 text-gray-900">
                New Risk Instance
                </h3>
                <div class="mt-2">
                    {% include 'back_office/snippets/ri_create_modal.html' %}
                    <p class="text-sm leading-5 text-gray-500">
                        Lorem ipsum dolor sit amet, test.
                    </p>
                </div>
            </div>
            <!-- Close button.  -->
            <div class="mt-5 sm:mt-6">
                <span class="flex w-full rounded-md shadow-sm">
                    <button @click="open = false" class="inline-flex justify-center w-full px-4 py-2 text-white bg-blue-500 rounded hover:bg-blue-700">
                    Done
                    </button>
                </span>
            </div>
        </div>
    </div>
</div>

<table class="min-w-full leading-normal">
    <thead>
        <th class="px-5 py-3 border-b border-gray-200 bg-white text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">
            {% trans "Title" %}
        </th>
        <th class="px-5 py-3 border-b border-gray-200 bg-white text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">
            {% trans "Parent Risk" %}
        </th>
        <th class="px-5 py-3 border-b border-gray-200 bg-white text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">
            {% trans "Current Risk Level" %}
        </th>
        <th class="px-5 py-3 border-b border-gray-200 bg-white text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">
            {% trans "Residual Risk Level" %}
        </th>
    </thead>
    <tbody>
        {% for instance in instances %}{% if instance.analysis == analysis %}
            <tr>
                <td class="px-5 py-5 border-b border-gray-200 bg-white text-sm">
                    <div class="flex items-center">

                        <div class="ml-3">
                            <a id="instance{{ instance.id }}" href="{% url 'ri-update' instance.id %}"
                            class="text-gray-900 text-md font-semibold whitespace-no-wrap hover:text-blue-500">
                                {{ instance.title }}
                            </a>
                        </div>
                    </div>
                </td>
                <td class="px-5 py-5 border-b border-gray-200 bg-white text-sm">
                    <p class="text-gray-900 whitespace-no-wrap capitalize">
                        {% if instance.parent_risk %}{{ instance.parent_risk }}{% else %}--{% endif %}
                    </p>
                </td>
                <td class="px-5 py-5 border-b border-gray-200 bg-white text-sm">
                    <p class="text-gray-900 whitespace-no-wrap">
                        {{ instance.current_level }}
                    </p>
                </td>
                <td class="px-5 py-5 border-b border-gray-200 bg-white text-sm">
                    {{ instance.residual_level }}
                </td>
            </tr>
        {% endif %}{% endfor %}
    </tbody>
</table>